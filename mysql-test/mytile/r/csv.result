# CSV Load Test
CREATE TABLE mbta_greenline (
`date` DATE dimension=1 lower_bound="0" upper_bound="2000000" tile_extent="365",
`MODE` varchar(4),
RIDERSHIP DOUBLE PRECISION,
COUNTOFDATES INTEGER,
AVG_RIDERSHIP DOUBLE PRECISION,
ROUTE_OR_LINE VARCHAR(255)
) ENGINE=mytile;
LOAD DATA
INFILE 'MBTA_Weekday_Greenline_Ridership_2019.csv'
     INTO TABLE mbta_greenline
FIELDS TERMINATED BY ','
     ENCLOSED BY '"'
     LINES TERMINATED BY '\n'
     IGNORE 1 LINES
(`date`, `MODE`, RIDERSHIP, COUNTOFDATES, AVG_RIDERSHIP, ROUTE_OR_LINE);
SELECT `date`, `MODE`, RIDERSHIP, COUNTOFDATES, AVG_RIDERSHIP, ROUTE_OR_LINE FROM mbta_greenline;
date	MODE	RIDERSHIP	COUNTOFDATES	AVG_RIDERSHIP	ROUTE_OR_LINE
2019-01-01	Rail	3174659.7582641	21	151174.27420305	Green Line
2019-02-01	Rail	3084859.198934	19	162361.01047021	Green Line
2019-03-01	Rail	3301698.0400953	21	157223.71619502	Green Line
2019-04-01	Rail	3612424.9755166	22	164201.13525075	Green Line
2019-05-01	Rail	3311065.6016364	22	150502.98189256	Green Line
LOAD DATA
INFILE 'empty.csv'
     INTO TABLE mbta_greenline
FIELDS TERMINATED BY ','
     ENCLOSED BY '"'
     LINES TERMINATED BY '\n'
     IGNORE 1 LINES
(`date`, `MODE`, RIDERSHIP, COUNTOFDATES, AVG_RIDERSHIP, ROUTE_OR_LINE);
SELECT `date`, `MODE`, RIDERSHIP, COUNTOFDATES, AVG_RIDERSHIP, ROUTE_OR_LINE FROM mbta_greenline;
date	MODE	RIDERSHIP	COUNTOFDATES	AVG_RIDERSHIP	ROUTE_OR_LINE
2019-01-01	Rail	3174659.7582641	21	151174.27420305	Green Line
2019-02-01	Rail	3084859.198934	19	162361.01047021	Green Line
2019-03-01	Rail	3301698.0400953	21	157223.71619502	Green Line
2019-04-01	Rail	3612424.9755166	22	164201.13525075	Green Line
2019-05-01	Rail	3311065.6016364	22	150502.98189256	Green Line
DROP TABLE mbta_greenline;
