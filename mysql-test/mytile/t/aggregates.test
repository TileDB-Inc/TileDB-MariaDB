--replace_result $MTR_SUITE_DIR MTR_SUITE_DIR
--eval CREATE TABLE dense ENGINE=mytile uri='$MTR_SUITE_DIR/test_data/tiledb_arrays/1.6/quickstart_dense';
DESCRIBE dense;
SELECT AVG(a) from dense;
select SUM(a) from dense;
select MAX(a) from dense;
select MIN(a) from dense;

set mytile_delete_arrays=0;
DROP TABLE dense;
set mytile_delete_arrays=1;

set mytile_enable_avg_and_sum_aggregate_pushdown=1;
--replace_result $MTR_SUITE_DIR MTR_SUITE_DIR
--eval CREATE TABLE dense ENGINE=mytile uri='$MTR_SUITE_DIR/test_data/tiledb_arrays/1.6/quickstart_dense';
DESCRIBE dense;
SELECT AVG(a) from dense;
SELECT SUM(a) from dense;
set mytile_enable_avg_and_sum_aggregate_pushdown=0;

set mytile_delete_arrays=0;
DROP TABLE dense;
set mytile_delete_arrays=1;

#################################################################################
# Nullable attributes
CREATE TABLE nulls (
dim0 int dimension=1 tile_extent="10",
attr0 bigint NULL,
attr1 float
) ENGINE=mytile;

INSERT INTO nulls VALUES (0, 0, 1.2), (1, null, 1.3), (2, 2, 1.4), (3, null, 1.5), (4, 2147483641, 1.6), (5, null, 1.7), (6, 2147483642, 1.8);

SELECT * FROM nulls;
select SUM(attr0) from nulls;
select MAX(attr0) from nulls;
select MIN(attr0) from nulls;
SELECT AVG(attr0) from nulls;

set mytile_enable_avg_and_sum_aggregate_pushdown=1;
SELECT AVG(attr1) from nulls;
select SUM(attr1) from nulls;
set mytile_enable_avg_and_sum_aggregate_pushdown=0;

DROP TABLE nulls;


